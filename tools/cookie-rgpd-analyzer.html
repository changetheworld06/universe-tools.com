<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Cookie & GDPR Analyzer (Local) | Universe Tools</title>
  <meta name="description" content="Analyze cookies accessible in your browser and get GDPR risk indicators. Local tool, no upload." />
  <meta name="robots" content="index,follow" />

  <!-- CSS global -->
  <link rel="stylesheet" href="/style.css" />

  <!-- Favicons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="icon" href="/favicon.ico">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#4f46e5" />

  <!-- Canonical + hreflang -->
  <link rel="canonical" href="https://universe-tools.com/tools/cookie-rgpd-analyzer.html" />
  <link rel="alternate" hreflang="en" href="https://universe-tools.com/tools/cookie-rgpd-analyzer.html" />
  <!-- (Tu n’as pas donné l’URL FR : je ne sais pas.) -->
  <link rel="alternate" hreflang="x-default" href="https://universe-tools.com/tools/cookie-rgpd-analyzer.html" />

  <!-- Google tag (GA4 + Ads) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-15ST5Y0Z1C"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-15ST5Y0Z1C');
    gtag('config', 'AW-325165312');
  </script>

  <!-- Event snippet (conversion) -->
  <script>
    function gtag_report_conversion(url) {
      var callback = function () { if (url) window.location = url; };
      gtag('event', 'conversion', {
        'send_to': 'AW-325165312/4_GXCKLGqcgbEIDChpsB',
        'event_callback': callback
      });
      return false;
    }
  </script>

  <!-- JSON-LD WebSite -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Universe Tools",
    "url": "https://universe-tools.com"
  }
  </script>

  <!-- JSON-LD WebApplication -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Cookie & GDPR Analyzer (Local)",
    "url": "https://universe-tools.com/tools/cookie-rgpd-analyzer.html",
    "description": "Analyze cookies accessible in your browser (via document.cookie) and get GDPR risk indicators. Local tool, no upload.",
    "applicationCategory": "Utility",
    "operatingSystem": "All",
    "isAccessibleForFree": true,
    "browserRequirements": "Requires JavaScript"
  }
  </script>
</head>

<body>
  <div class="page">

    <!-- HEADER -->
    <header>
      <div class="container nav">
        <a class="brand" href="/">
          <div class="brand-logo" aria-hidden="true">
            <svg width="34" height="34" viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg">
              <defs>
                <linearGradient id="grad2" x1="0%" y1="0%" x2="120%" y2="120%">
                  <stop offset="0%" stop-color="#4f46e5"/>
                  <stop offset="40%" stop-color="#7c3aed"/>
                  <stop offset="100%" stop-color="#ec4899"/>
                </linearGradient>
              </defs>
              <circle cx="30" cy="30" r="22" fill="none" stroke="url(#grad2)" stroke-width="3"/>
              <circle cx="30" cy="12" r="5" fill="url(#grad2)"/>
              <ellipse cx="30" cy="30" rx="28" ry="10" fill="none" stroke="url(#grad2)" stroke-width="2" opacity="0.6"/>
            </svg>
          </div>
          <div class="brand-text">
            <div class="brand-name">Universe Tools</div>
            <div class="brand-tagline">All your everyday tools in one place.</div>
          </div>
        </a>

        <nav class="nav-links" aria-label="Primary">
          <a href="/#tools">Tools</a>
          <a href="/legal.html">Legal</a>
          <a href="/privacy.html">Privacy</a>
        </nav>

        <button class="nav-cta" type="button" onclick="window.location.href='/'">
          <span>Try another tool</span>
          <span>→</span>
        </button>
      </div>
    </header>

    <!-- CONTENT -->
    <main>
      <section class="section">
        <div class="container">

          <div class="section-header">
            <h1 class="section-title">Cookie & GDPR Analyzer (local)</h1>
            <p class="section-subtitle">
              Reads cookies accessible via <code>document.cookie</code> and flags common tracking patterns.
              No upload. Note: <code>HttpOnly</code> cookies are not visible to JavaScript.
            </p>
          </div>

          <article class="tool-section">
            <p>
              Paste an optional list of cookies you expect (one per line) and compare with what the browser exposes.
              This helps spot unexpected tracking cookies.
            </p>

            <form class="tool-form" onsubmit="event.preventDefault();">
              <div class="field">
                <label for="expected">Expected cookies (optional, one per line)</label>
                <textarea id="expected" rows="5" placeholder="Example:
_ga
_gid
sessionid"></textarea>
                <small>Leave empty to analyze current readable cookies only.</small>
              </div>

              <div class="field">
                <label for="strictMode">Classification mode</label>
                <select id="strictMode">
                  <option value="normal" selected>Normal</option>
                  <option value="strict">Strict (more tracking matches)</option>
                </select>
                <small>Strict flags more cookies as “tracking”.</small>
              </div>

              <div class="field">
                <label for="filter">Filter</label>
                <input id="filter" type="text" placeholder="Search cookie name..." />
                <small>Instant filter (client-side).</small>
              </div>

              <div class="field">
                <label for="sort">Sort</label>
                <select id="sort">
                  <option value="risk" selected>Risk (high → low)</option>
                  <option value="name">Name (A → Z)</option>
                </select>
                <small>Sorting only (display).</small>
              </div>

              <div class="field">
                <button id="btnAnalyze" class="btn-tool" type="button">Analyze</button>
              </div>

              <div class="field">
                <button id="btnReset" class="btn-tool" type="button">Reset</button>
              </div>

              <div class="field">
                <button id="btnCopy" class="btn-tool" type="button" disabled>Copy report</button>
              </div>
            </form>

            <div id="quickResults" class="tool-result" style="display:none;" aria-live="polite"></div>

            <div id="tableWrap" style="display:none; margin-top:14px;">
              <div style="overflow-x:auto;">
                <table style="width:100%; border-collapse:collapse;">
                  <thead>
                    <tr>
                      <th style="text-align:left; padding:10px;">Cookie name</th>
                      <th style="text-align:left; padding:10px;">Category</th>
                      <th style="text-align:left; padding:10px;">GDPR risk</th>
                      <th style="text-align:left; padding:10px;">Expected?</th>
                    </tr>
                  </thead>
                  <tbody id="tbody"></tbody>
                </table>
              </div>

              <div id="msg" class="small-note" style="margin-top:10px;"></div>

              <div class="small-note" style="margin-top:10px;">
                <strong>Limitations:</strong> This tool can’t read <code>HttpOnly</code> cookies, server-side cookies,
                or some third-party cookies blocked by the browser. This is a quick indicator, not a legal audit.
              </div>
            </div>
          </article>

          <!-- SEO paragraph -->
          <section class="tool-section" aria-label="Cookie analyzer guide">
            <h2>Cookie analyzer: what it checks and how to interpret results</h2>

            <p>
              A <strong>cookie & GDPR analyzer</strong> helps you quickly review what your browser can read through
              <code>document.cookie</code>. This is useful to spot common analytics or advertising identifiers, and to
              compare them with an expected list (for example, cookies your consent banner should allow only after opt-in).
            </p>

            <p>
              This tool uses <strong>simple local heuristics</strong> (keyword matching) to flag cookies that look like
              tracking or analytics identifiers. It also highlights cookies that are <strong>unexpected</strong> compared
              to your own list. Because it runs 100% in your browser, no cookie values are uploaded.
            </p>

            <p>
              Keep in mind: many important cookies can be <strong>invisible to JavaScript</strong> (for example
              <code>HttpOnly</code> cookies). A proper compliance review usually involves checking your consent platform (CMP),
              tag manager setup, and documentation (privacy/cookie policy, consent logs).
            </p>
          </section>

          <!-- RELATED TOOLS (maillage interne) -->
          <section class="section" aria-label="Related tools">
            <div class="section-header" style="margin-top:24px;">
              <h2 class="section-title" style="font-size:18px;">Related tools</h2>
              <p class="section-subtitle" style="font-size:13px;">
                More tools you may like (same category when possible).
              </p>
            </div>
            <div id="relatedGrid" class="tools-grid"></div>
          </section>

        </div>
      </section>
    </main>

    <!-- FOOTER -->
    <footer>
      <div class="container footer-inner">
        <span>© <span id="year"></span> Universe Tools</span>
        <span>Local calculation only</span>
      </div>
    </footer>

  </div>

  <!-- Tools data (global TOOLS_DATA) -->
  <script src="/assets/tools-data.js"></script>

  <script>
    const $ = (id) => document.getElementById(id);

    // Footer year
    document.getElementById("year").textContent = new Date().getFullYear();

    // --- Heuristics (local, no API) ---
    const TRACK_KEYS_NORMAL = [
      "_ga","_gid","_gat","ga","gid","gtm","gcl","ad","ads","doubleclick","dclid","fbp","fbc","pixel",
      "analytics","utm","track"
    ];
    const TRACK_KEYS_STRICT = [
      ...TRACK_KEYS_NORMAL,
      "id","uid","uuid","visitor","session","client","device","fingerprint","cmp","consent"
    ];

    function normalizeName(s){
      return String(s || "").trim();
    }

    function getReadableCookies(){
      const raw = document.cookie || "";
      if (!raw.trim()) return [];
      return raw.split(";").map(x => normalizeName(x.split("=")[0]));
    }

    function parseExpected(){
      const raw = $("expected").value || "";
      return new Set(
        raw.split("\n")
          .map(x => normalizeName(x))
          .filter(Boolean)
          .map(x => x.toLowerCase())
      );
    }

    function classify(name, strict){
      const n = name.toLowerCase();
      const keys = strict ? TRACK_KEYS_STRICT : TRACK_KEYS_NORMAL;

      if (keys.some(k => n.includes(k))) return { cat: "Tracking / Analytics", risk: "High", score: 3 };
      if (n.includes("sess") || n.includes("session") || n.startsWith("sid")) return { cat: "Session", risk: "Medium", score: 2 };
      if (n.includes("pref") || n.includes("lang") || n.includes("theme")) return { cat: "Preferences", risk: "Low", score: 1 };
      return { cat: "Functional", risk: "Low", score: 1 };
    }

    function buildReport(rows, totals){
      const lines = [];
      lines.push("Universe Tools — Cookie & GDPR Analyzer");
      lines.push("Readable cookies via document.cookie (JavaScript)");
      lines.push("");
      lines.push(`Total: ${totals.total}`);
      lines.push(`Tracking signals: ${totals.tracking}`);
      lines.push(`Unexpected: ${totals.unexpected}`);
      lines.push("");
      lines.push("Details:");
      rows.forEach(r => {
        lines.push(`- ${r.name} | ${r.cat} | risk=${r.risk} | expected=${r.expected ? "yes" : "no"}`);
      });
      return lines.join("\n");
    }

    function render(){
      const strict = $("strictMode").value === "strict";
      const expected = parseExpected();
      const filter = ($("filter").value || "").trim().toLowerCase();
      const sort = $("sort").value;

      const base = getReadableCookies();
      const rows = base
        .map(name => {
          const meta = classify(name, strict);
          const isExp = expected.size ? expected.has(name.toLowerCase()) : true;
          return { name, expected: isExp, ...meta };
        })
        .filter(r => !filter || r.name.toLowerCase().includes(filter));

      if (sort === "name") rows.sort((a,b) => a.name.localeCompare(b.name));
      else rows.sort((a,b) => (b.score - a.score) || a.name.localeCompare(b.name));

      const totalAll = base.length;
      const trackingAll = base.filter(n => classify(n, strict).risk === "High").length;
      const unexpectedAll = expected.size ? base.filter(n => !expected.has(n.toLowerCase())).length : 0;

      // quick summary (simple, using existing classes)
      $("quickResults").style.display = "block";
      $("quickResults").innerHTML = `
        <strong>Readable cookies: ${totalAll}</strong>
        <span>Tracking signals: ${trackingAll}</span>
        <span>Unexpected: ${expected.size ? unexpectedAll : "—"}</span>
      `;

      $("tableWrap").style.display = "block";

      const tbody = $("tbody");
      tbody.innerHTML = rows.length ? "" : `<tr><td colspan="4" style="padding:10px;">No readable cookies matched your filter.</td></tr>`;

      rows.forEach(r => {
        const expTxt = expected.size ? (r.expected ? "yes" : "no") : "n/a";
        tbody.insertAdjacentHTML("beforeend", `
          <tr>
            <td style="padding:10px;">${escapeHtml(r.name)}</td>
            <td style="padding:10px;">${escapeHtml(r.cat)}</td>
            <td style="padding:10px;">${escapeHtml(r.risk)}</td>
            <td style="padding:10px;">${escapeHtml(expTxt)}</td>
          </tr>
        `);
      });

      // message
      if (!totalAll){
        $("msg").textContent = "No readable cookies detected via document.cookie.";
      } else if (trackingAll){
        $("msg").textContent = "Tracking signals detected. Ensure non-essential cookies are blocked until consent.";
      } else {
        $("msg").textContent = "No obvious tracking signals detected in readable cookies.";
      }

      // enable copy
      $("btnCopy").disabled = (totalAll === 0);

      // store report for copy
      const rowsAll = base.map(name => {
        const meta = classify(name, strict);
        const isExp = expected.size ? expected.has(name.toLowerCase()) : true;
        return { name, expected: isExp, cat: meta.cat, risk: meta.risk };
      });

      $("btnCopy").dataset.report = buildReport(rowsAll, {
        total: totalAll,
        tracking: trackingAll,
        unexpected: unexpectedAll
      });
    }

    async function copyReport(){
      const txt = $("btnCopy").dataset.report || "";
      if (!txt) return;
      try{
        await navigator.clipboard.writeText(txt);
        $("msg").textContent = "Report copied to clipboard.";
      }catch{
        $("msg").textContent = "Copy failed (browser restriction).";
      }
    }

    function resetAll(){
      $("expected").value = "";
      $("strictMode").value = "normal";
      $("filter").value = "";
      $("sort").value = "risk";
      $("quickResults").style.display = "none";
      $("tableWrap").style.display = "none";
      $("tbody").innerHTML = "";
      $("msg").textContent = "";
      $("btnCopy").disabled = true;
      $("btnCopy").dataset.report = "";
    }

    function escapeHtml(str) {
      return String(str)
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    document.addEventListener("DOMContentLoaded", () => {
      resetAll();
      $("btnAnalyze").addEventListener("click", render);
      $("btnReset").addEventListener("click", resetAll);
      $("btnCopy").addEventListener("click", copyReport);

      $("filter").addEventListener("input", () => {
        if ($("tableWrap").style.display !== "none") render();
      });
      $("sort").addEventListener("change", () => {
        if ($("tableWrap").style.display !== "none") render();
      });
      $("strictMode").addEventListener("change", () => {
        if ($("tableWrap").style.display !== "none") render();
      });
    });

    // ===== Related tools cards (same “maillage” everywhere) =====
    (function renderRelated(){
      const grid = document.getElementById("relatedGrid");
      if (!grid) return;

      const data = window.TOOLS_DATA;
      if (!Array.isArray(data) || data.length === 0) {
        grid.innerHTML = "";
        return;
      }

      const currentSlug = (location.pathname.split("/").pop() || "").replace(".html", "");
      const current = data.find(t => t.slug === currentSlug);
      const currentCategory = current && current.category ? current.category : null;

      let picks = data.filter(t => t.slug !== currentSlug && currentCategory && t.category === currentCategory);

      if (picks.length < 6) {
        const rest = data.filter(t => t.slug !== currentSlug && (!currentCategory || t.category !== currentCategory));
        picks = picks.concat(rest);
      }

      picks = picks.slice(0, 6);

      grid.innerHTML = picks.map(t => {
        const title = escapeHtml(t.name || t.slug || "Tool");
        const badge = escapeHtml(t.category || "Tool");
        const desc = escapeHtml(t.desc || "");
        const href = t.path || (`/tools/${t.slug}.html`);
        return `
          <a class="tool-card" href="${href}">
            <div class="tool-card-top">
              <div class="tool-title">${title}</div>
              <div class="tool-badge">${badge}</div>
            </div>
            <div class="tool-desc">${desc}</div>
            <div class="tool-foot">Local</div>
          </a>
        `;
      }).join("");
    })();
  </script>

  <!-- Minimal CSS fallback for related cards if your global style.css doesn't include it -->
  <style>
    .tools-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 14px;
    }
    @media (max-width: 900px) { .tools-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
    @media (max-width: 560px) { .tools-grid { grid-template-columns: 1fr; } }

    .tool-card {
      display: block;
      padding: 16px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      text-decoration: none;
      color: inherit;
    }
    .tool-card:hover {
      border-color: rgba(120,140,255,.45);
      box-shadow: 0 0 0 1px rgba(120,140,255,.20) inset;
    }
    .tool-card-top {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 10px;
      margin-bottom: 8px;
    }
    .tool-title { font-weight: 700; line-height: 1.2; }
    .tool-badge {
      font-size: 12px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(120,140,255,.45);
      background: rgba(120,140,255,.08);
      white-space: nowrap;
    }
    .tool-desc { opacity: .78; font-size: 13px; line-height: 1.35; min-height: 34px; }
    .tool-foot { margin-top: 10px; font-size: 12px; opacity: .65; }
  </style>

</body>
</html>